!function(a){"use strict";function b(a,b){function c(a){var b={"":{"":"D0B27254-F6C0-4946-80BC-A3A400E3FE92",ru:"47C540AE-DAFB-420C-861F-A3A400E3D326"},1:{"":"FDC51D96-C961-4967-A4CE-A3930133F11F",ru:"535E0FD1-2DB2-4906-B421-A3930133E774"}};b[1]=b[1];var c=void 0!==a.keeperType?a.keeperType:"",d=b[c]||b[""],e=d[k]||d[""];return encodeURI(q.login+"GateKeeper.aspx")+"?RID="+e+"&Quiet=1&WmId="+encodeURIComponent(a.wmId)}function d(a){return encodeURI(q.login+"GateKeeper.aspx?RID=48CEEC81-2DF4-4B3A-B0BA-A0CB0106D464&Quiet=1&WmId=")+encodeURIComponent(a.wmId)}function e(a,b){if(a.avatarUrl){if("Tiny"===b)return encodeURI(a.avatarUrl);var c=/tiny((\.)(\w+))?$/i;if(c.test(a.avatarUrl))return encodeURI(a.avatarUrl.replace(c,b+"$2$3"));var d=/(\?|\&)s=tiny(\&|$)/i;return d.test(a.avatarUrl)?encodeURI(a.avatarUrl.replace(d,"$1s="+b+"$2")):encodeURI(a.avatarUrl)}return encodeURI("https://events.webmoney.ru/open/avatar.aspx?w=")+encodeURIComponent(a.wmId)+"&t=Url&serp="+b+"&a=1"}function f(){return encodeURI(q.login+"GateKeeper/Options.aspx")}function g(b){if(a.isFunction(q.userSignoff))return q.userSignoff.call(q,b);if(!q.userSignoff&&q.rid&&(q.userSignoff=q.login+"GateKeeper/LogOff.aspx?RID=__rid__&WmId=__wmId__&ReturnUrl=__returnUrl__"),q.userSignoff)return encodeURI(q.userSignoff).replace("__rid__",encodeURIComponent(q.rid)).replace("__wmId__",encodeURIComponent(b.wmId)).replace("__returnUrl__",encodeURIComponent(q.returnUrl));throw new Error("User sign off URI is not set up with the URI services.")}function h(b){if(a.isFunction(q.userChange))return q.userChange.call(q,b);if(b&&q.userChange)return encodeURI(q.userChange).replace("__rid__",encodeURIComponent(q.rid)).replace("__wmId__",encodeURIComponent(b.wmId)).replace("__quiet__","1").replace("__returnUrl__",encodeURIComponent(q.returnUrl));if(q.userChangeNew)return encodeURI(q.userChangeNew).replace("__rid__",encodeURIComponent(q.rid)).replace("__wmId__","").replace("__quiet__","0").replace("__returnUrl__",encodeURIComponent(q.returnUrl));throw new Error("User change URI is not set up with the URI services.")}var i="undefined"!=typeof _encodeHTML?_encodeHTML:function(a){var b={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},c=a?/[&<>"'\/]/g:/&(?!#?\w+;)|<|>|"|'|\//g;return function(a){return a?a.toString().replace(c,function(a){return b[a]||a}):""}}(),j="",k=b.lang||a("html").attr("lang")||"";k.length>2&&(k=k.substr(0,2)),k=k.toLowerCase();var l={User_Change:{"":"Log in another WMID",es:"Entrar en otro WMID",pt:"Log em outro WMID",ru:"Войти другим WMID",tr:"Başka bir WMID ile giriş yapın",vi:"Đăng nhập với WMID khác"},User_Settings:{"":"Login settings",es:"Configuraciones de Sesión",pt:"Configurações de sessão",ru:"Настройки входа",tr:"Giriş ayarları",vi:"Thiết lập đăng nhập"},User_SignOff:{"":"Log out",es:"Cerrar sesión",pt:"Desligar",ru:"Выход",tr:"Çıkış",vi:"Đăng xuất"},Back:{"":"Back",es:"Atrás",pt:"Voltar",ru:"Назад",tr:"Geri",vi:"Trở lại"}},m=b.sr||{},n={User_Change:m.User_Change||l.User_Change[k]||l.User_Change[""],User_Settings:m.User_Settings||l.User_Settings[k]||l.User_Settings[""],User_SignOff:m.User_SignOff||l.User_SignOff[k]||l.User_SignOff[""],Back:m.Back||l.Back[k]||l.Back[""]},o=b.rememberStateUnknown===!0,p=b.uriService||{},q={login:p.login||"https://login.wmtransfer.com/",userSignoff:p.userSignoff,userChange:p.userChange,userChangeNew:p.userChangeNew,rid:p.rid,returnUrl:p.returnUrl||window.location};if(!(q.userSignoff&&q.userChange||q.rid))throw new Error("Required parameter it.uriService is missing or contains an invalid value.");if(q.login.lastIndexOf("/")!==q.login.length-1&&(q.login=q.login+"/"),!q.userChangeNew)if(a.isFunction(q.userChange));else if(q.userChange){var r=/(\?|\&)WmId=__wmId__(\&|$)/i;o&&r.test(q.userChange)?q.userChangeNew=q.userChange.replace(r,"$1"):q.userChangeNew=q.userChange}else q.userChangeNew=q.login+"GateKeeper.aspx?RID=__rid__"+(o?"":"&WmId=__wmId__")+"&Quiet=0&ReturnUrl=__returnUrl__";q.userChange||(q.userChange=q.login+"GateKeeper.aspx?RID=__rid__&WmId=__wmId__&Quiet=__quiet__&ReturnUrl=__returnUrl__");var s=b.currentWmId,t=b.data;if(!t)throw new Error("Required parameter it.data is missing.");var u,v=t.users;for(var w in v)if(v.hasOwnProperty(w)){var x=v[w];x.wmId===s&&(u=x)}u||(u={}),u.wmId||(u.wmId=s),u.displayName||(u.displayName=s),j+='<div class="clearfix"> <a target="_blank" href="'+d(u)+'" class="user-link-to-events"> <img id="avatar" src="'+e(u,"Tiny")+'" alt="',u.displayName&&u.displayName!==u.wmId||(j+="WMID: "),j+=""+i(u.displayName||u.wmId)+'" title="',u.displayName&&u.displayName!==u.wmId||(j+="WMID: "),j+=""+i(u.displayName||u.wmId)+'" /> <span id="wmid">WMID - '+i(u.wmId)+'</span> <span id="nickname">WMID: '+i(u.wmId)+'</span> </a> <a class="icon-log-off" href="'+g(u)+'" id="log-off"> </a></div><div class="login_popup_cont"> <div class="user_top_info"> <a target="_blank" href="'+d(u)+'" class="uti_img"> <img src="'+e(u,"Small")+'" alt="',u.displayName&&u.displayName!==u.wmId||(j+="WMID: "),j+=""+i(u.displayName||u.wmId)+'" title="',u.displayName&&u.displayName!==u.wmId||(j+="WMID: "),j+=""+i(u.displayName||u.wmId)+'" /> </a> <div class="uti_descr"> <a target="_blank" href="'+d(u)+'" class="user_nickname"> <span>',u.displayName&&u.displayName!==u.wmId||(j+="WMID: "),j+=""+i(u.displayName||u.wmId)+'</span> </a> <a target="_blank" href="'+c(u)+'" class="user_purse"> <span>'+i(u.wmId)+'</span> </a> <a href="'+g(u)+'" class="user_logout"> '+i(n.User_SignOff)+' </a> </div> </div> <ul class="wmid_dop"> ';var y=t.users;if(y)for(var z,A=-1,B=y.length-1;B>A;)z=y[A+=1],j+=" ",z.wmId!==u.wmId&&(j+=' <li> <a href="'+h(z)+'"> <img src="'+e(z,"Tiny")+'" /> <div class="u_info"> <div class="u_nickname">',z.displayName&&z.displayName!==z.wmId||(j+="WMID: "),j+=""+i(z.displayName||z.wmId)+'</div> <div class="u_wmid">'+i(z.wmId)+"</div> </div> </a> </li> "),j+=" ";return j+=' </ul> <a href="'+h(null)+'" class="add_wmid"> '+i(n.User_Change)+' </a> <a target="_blank" href="'+f()+'" class="login_settings"> '+i(n.User_Settings)+' </a> <a href="" class="login_close"> '+i(n.Back)+" </a></div>"}function c(a){function c(){if(a.isCorsFullSupported===!0)return!0;if(a.isCorsFullSupported===!1)return!1;if("XMLHttpRequest"in window&&"withCredentials"in new XMLHttpRequest){var b=window.navigator.userAgent,c=b.indexOf("MSIE ")<0&&b.indexOf("Trident/")<0;return c}return!1}function d(a,b){function c(a){var b=a.hostname,c=b.search(/(\w+(\.\w+))$/g),d=c>=0?b.substr(c):b;return d}var d=document.createElement("a");d.href=b;var e=c(a),f=c(d);return f&&e&&f===e}var e=window.jQuery;a||(a={});var f,g=a.uriService||{};g.loginSso?f=g.loginSso:(g.login||(g.login="https://login.wmtransfer.com/"),g.login.lastIndexOf("/")!==g.login.length-1&&(g.login=g.login+"/"),f=g.login+"GateKeeper/SingleSignOn.js");var h,i=g.location||window.location,j=function(){var b={};return b.sessionSetCalled=function(a){var b=window.sessionStorage;b&&b.setItem("SingleSignOnCalled",a?"true":"false")},b.sessionGetCalled=function(){var a=window.sessionStorage;return a?"true"===a.getItem("SingleSignOnCalled"):!1},b.handleData=function(c){function d(a){if(e.isFunction(g.userChange))return g.userChange.call(g,a);if(a&&g.userChange)return encodeURI(g.userChange).replace("__rid__",encodeURIComponent(g.rid)).replace("__wmId__",encodeURIComponent(a.wmId)).replace("__quiet__","1").replace("__returnUrl__",encodeURIComponent(g.returnUrl));if(g.userChangeNew)return encodeURI(g.userChangeNew).replace("__rid__",encodeURIComponent(g.rid)).replace("__wmId__","").replace("__quiet__","0").replace("__returnUrl__",encodeURIComponent(g.returnUrl));throw new Error("User change URI is not set up with the URI services.")}if(c&&c.loggedOn&&c.wmId&&(a.signOnAlways||!b.sessionGetCalled())){b.sessionSetCalled(!0),g.userChange||(g.userChange=g.login+"GateKeeper.aspx?RID=__rid__&WmId=__wmId__&Quiet=__quiet__&ReturnUrl=__returnUrl__");var f={wmId:c.wmId},h=d(f),i=a.redirect||function(a){window.location=a};i(h)}},b}(),k=function(){function c(c,d){var f,h=a.wmId||c.wmId,i=b(e,{currentWmId:h,data:c,sr:a.sr,lang:a.lang,uriService:g,rememberStateUnknown:d});if(a.placeholder)f=a.placeholder;else{var j=e('[data-role="header-user-block"]');j.length>0&&(f=j);var k=e("#header-user-block");k.length>0&&(f=k),f=e(".header-user-block")}f.html(i)}var d={};return d.handleData=function(b){var d,e,f;(a.wmId||b&&b.wmId&&b.loggedOn)&&j.sessionSetCalled(!0),b&&b.users?(e=!1,d=b):b?(f=a.wmId||b.wmId,e=!1,d={}):a.wmId&&(f=a.wmId,e=!0,d={}),d&&c(d,e)},d}();if(a.handleData)h=a.handleData;else if(a.signOn){if(!g.userChange&&!g.rid)throw new Error("Required parameter options.uriService is missing or contains an invalid value.");g.returnUrl||(g.returnUrl=window.location),h=j.handleData}else h=k.handleData;if(c()||d(i,f)){var l={url:f,method:"GET",data:{type:"cors"},cache:!0,dataType:"json",success:h,xhrFields:{withCredentials:!0},crossDomain:!0};e.ajax(l)}else h(void 0)}function d(){var b=[function(){return f?a(f):null},function(){return a('[data-role="header-user-block"]')},function(){return a("#header-user-block")},function(){return a(".header-user-block")},function(){return a(".header-user-buttons")}],d=null,e=null;for(var g in b)if(b.hasOwnProperty(g)&&(d=b[g]())){if(e=d.data(),e&&(e.wmid||e.signOn===!0))break;d=null,e=null}if(d&&e){"SCRIPT"===d.prop("tagName")&&(d=a('<td class="header-user-block"></td>').insertAfter(d)),e.wmId=e.wmid;var h=12,i=""+e.wmId;i.length<h&&(i="000000000000".substr(0,h-i.length)+i),e.wmId=i,e.sr||(e.sr={},e.srUserChange&&(e.sr.User_Change=e.srUserChange),e.srUserSettings&&(e.sr.User_Settings=e.srUserSettings),e.srUserSignoff&&(e.sr.User_SignOff=e.srUserSignoff),e.srBack&&(e.sr.Back=e.srBack)),e.uriservice||(e.uriservice={},e.uriserviceUserSignoff&&(e.uriservice.userSignoff=e.uriserviceUserSignoff),e.uriserviceUserChangeNew&&(e.uriservice.userChangeNew=e.uriserviceUserChangeNew),e.uriserviceUserChange&&(e.uriservice.userChange=e.uriserviceUserChange),e.uriserviceRid&&(e.uriservice.rid=e.uriserviceRid),e.uriserviceReturnurl&&(e.uriservice.returnUrl=e.uriserviceReturnurl),e.uriserviceLogin&&(e.uriservice.login=e.uriserviceLogin),e.uriserviceLoginSso&&(e.uriservice.loginSso=e.uriserviceLoginSso)),e.uriService=e.uriservice,e.placeholder=d;var j=window.loadUserBlock||c;j(e)}}var e=document.getElementsByTagName("script"),f=e[e.length-1];a(d)}(window.jQuery),jQuery(function(a){a(".header-user").on("click",".user-link-to-events",function(b){b.preventDefault(),a(this).toggleClass("active"),a(".login_popup_cont").toggleClass("active"),a("body").append('<div class="overlay_bg"></div>')}),a(document).on("click",function(b){a(b.target).parents().addBack().is(".user-link-to-events")||(a(".user-link-to-events, .login_popup_cont").removeClass("active"),a(".overlay_bg").hide())}),a(".login_popup_cont").on("click",function(a){a.stopPropagation()}),a(".header-user").on("click",".login_close",function(b){return b.preventDefault(),a(".overlay_bg").hide(),a(".user-link-to-events, .login_popup_cont").removeClass("active"),!1})});